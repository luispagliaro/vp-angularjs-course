<html ng-app="gemStore">

<head>
  <title>Gem Store</title>
  <script src="js/angular.min.js"></script>
  <script src="js/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/app.js"></script>
  <script src="js/StoreController.js"></script>
  <script src="js/TabController.js"></script>
  <script src="js/GalleryController.js"></script>
  <script src="js/ReviewController.js"></script>
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
</head>

<body class="container" ng-controller="StoreController as store">
  <main class="panel panel-primary">
    <header class="panel-heading">
      <h1 class="text-center">Gem Store</h1>
    </header>
    <ul class="panel-body list-group text-center">
      <li class="product row list-group-item" ng-hide="product.soldOut" ng-repeat="product in store.products">
        <h3 class="page-header">{{ product.name }} <em class="small">{{ product.price | currency}}</em></h3>
        <figure class="gallery" ng-if="product.images != []" ng-controller="GalleryController as gallery">
          <img ng-src="images/{{ product.images[gallery.current] }}">
          <div>
            <img class="small-image" ng-src="images/{{ image }}" ng-repeat="image in product.images" ng-hide="$index == gallery.current" ng-click="gallery.setCurrent($index)">
          </div>
        </figure>
        <section class="tab text-center" ng-controller="TabController as tab">
          <ul class="nav nav-tabs">
            <li class="active" ng-class="{active:tab.isSet(1)}">
              <a href ng-click="tab.setTab(1)">Description</a>
            </li>
            <li ng-class="{active:tab.isSet(2)}">
              <a href ng-click="tab.setTab(2)">Specs</a>
            </li>
            <li ng-class="{active:tab.isSet(3)}">
              <a href ng-click="tab.setTab(3)">Reviews</a>
            </li>
          </ul>
          <div class="well">
            <div ng-show="tab.isSet(1)" class="product-description" ng-include="'views/product-description.html'"></div>
            <div ng-show="tab.isSet(2)" class="product-specs">
              <ul class="list-inline row">
                <li class="col-sm-3"><strong>Shine</strong>: {{ product.shine }}</li>
                <li class="col-sm-3"><strong>Rarity</strong>: {{ product.rarity }}</li>
                <li class="col-sm-3"><strong>Color</strong>: <span ng-style="{color:'{{ product.color }}'}">{{ product.color }}</span></li>
                <li class="col-sm-3"><strong>Faces</strong>: {{ product.faces }}</li>
              </ul>
            </div>
            <div ng-show="tab.isSet(3)" class="product-reviews">
              <form name="reviewForm" class="form-horizontal" ng-controller="ReviewController as reviewCtrl" ng-submit="reviewForm.$valid && reviewCtrl.addReview(product) && reviewForm.$setPristine() && reviewForm.$setUntouched()" novalidate>
                <fieldset>
                  <legend>Add a review</legend>
                  <div class="form-group row" ng-class="{'has-success':reviewForm.stars.$valid,'has-error':reviewForm.stars.$dirty && reviewForm.stars.$invalid}">
                    <label for="inputStars" class="col-sm-5 control-label">Stars</label>
                    <div class="col-sm-3">
                      <select class="form-control" name="stars" ng-options="stars for stars in [1,2,3,4,5]" ng-model="reviewCtrl.review.stars" required>
                        <option value="" disabled selected>Rate the gem</option>
                      </select>
                    </div>
                  </div>
                  <small class="text-danger" ng-show="reviewForm.stars.$dirty && reviewForm.stars.$invalid">Please, rate the gem before submitting the review</small>
                  <div class="form-group row" ng-class="{'has-success':reviewForm.comment.$valid,'has-error':reviewForm.comment.$dirty && reviewForm.comment.$invalid}">
                    <label for="inputComment" class="col-sm-5 control-label">Comment</label>
                    <div class="col-sm-3">
                      <textarea class="form-control" rows="4" placeholder="Enter a comment" name="comment" ng-minlength="1" ng-model="reviewCtrl.review.body" required></textarea>
                    </div>
                  </div>
                  <small class="text-danger" ng-show="reviewForm.comment.$dirty && reviewForm.comment.$invalid">Please, write a comment before submitting the review</small>
                  <div class="form-group row" ng-class="{'has-success':reviewForm.email.$valid,'has-error':reviewForm.email.$dirty && reviewForm.email.$invalid}">
                    <label for="inputEmail" class="col-sm-5 control-label">Email</label>
                    <div class="col-sm-3">
                      <input type="email" class="form-control" placeholder="Enter your Email" name="email" ng-model="reviewCtrl.review.author" required>
                    </div>
                  </div>
                  <small class="text-danger" ng-show="reviewForm.email.$dirty && reviewForm.email.$invalid">Please, verify your email address</small>
                  <button type="submit" class="btn btn-default" ng-disabled="reviewForm.$invalid">Submit</button>
                </fieldset>
                <blockquote class="text-left" ng-show="(reviewForm.comment.$valid || reviewForm.stars.$valid || reviewForm.email.$valid)">
                  <small><time>{{ reviewCtrl.review.createdOn | date }}</time></small>
                  <p ng-show="reviewForm.comment.$valid">{{ reviewCtrl.review.body }}</p>
                  <div class="text-right">
                    <strong ng-show="reviewForm.stars.$valid">{{ reviewCtrl.review.stars }} star<span ng-hide="reviewCtrl.review.stars == 1">s</span></strong><span ng-show="reviewForm.stars.$valid && reviewForm.email.$valid"> - </span>
                    <cite>{{ reviewCtrl.review.author }}</cite>
                  </div>
                </blockquote>
              </form>
              <ul class="reviews">
                <li ng-repeat="review in product.reviews">
                  <blockquote class="text-left">
                    <small><time>{{ review.createdOn | date }}</time></small>
                    <p>{{ review.body }}</p>
                    <div class="text-right">
                      <strong>{{ review.stars }} star<span ng-hide="review.stars == 1">s</span></strong> -
                      <cite>{{ review.author }}</cite>
                    </div>
                  </blockquote>
                </li>
              </ul>
            </div>
          </div>
        </section>
        <button class="btn btn-success" type="button" ng-show="product.canPurchase">Add to Cart</button>
      </li>
    </ul>
    <footer class="panel-footer panel-primary text-center">Gem Store. Developed by Luis Pagliaro.</footer>
  </main>
</body>

</html>